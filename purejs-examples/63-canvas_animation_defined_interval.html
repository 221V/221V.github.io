<!DOCTYPE HTML>
<html>
  <head>
  <meta charset="utf-8" />
  <title>Canvas animation at a specified interval</title>
    <style>
      body {
        margin:0;
        padding:0;
        background-color:white;
      }
      canvas{
        //background-color:#FFF;
        border:1px solid red;
      }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width="512" height="512"></canvas>
<script>
'use strict';

var canvas = document.getElementById('myCanvas');
var ctx = canvas.getContext('2d');

var cw=canvas.width;
var ch=canvas.height;
//canvas.style.border='1px solid red';


// animation interval variables
var nextTime=0;// the next animation begins at "nextTime"
var duration=1000;// run animation every 1000ms
var x=20;// the X,Y where the next rect is drawn
var y=30;

// start the animation
requestAnimationFrame(animate);

function animate(currentTime){
  // wait for nextTime to occur
  if(currentTime<nextTime){
    // request another loop of animation
    requestAnimationFrame(animate);
    // time hasn't elapsed so just return
    return;
  }
  // set nextTime
  nextTime=currentTime+duration;
  // add another rectangle every 1000ms
  ctx.fillStyle='#'+Math.floor(Math.random()*16777215).toString(16);
  ctx.fillRect(x,y,30,30);
  // update X,Y position for next rectangle
  if((x + 30*2) > cw){ x=20; y+=30; }else{ x+=30; }
  if((y + 30) > ch){ return; }
  // request another loop of animation
  requestAnimationFrame(animate);
}



</script>
  </body>
</html>
