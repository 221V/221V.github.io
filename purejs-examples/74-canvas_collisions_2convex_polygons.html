<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <title>Canvas collisions 2 convex polygons</title>
    <style>
      body {
        margin:0;
        padding:0;
        background-color:white;
      }
      canvas{
        //background-color:#FFF;
        border:1px solid red;
      }
    </style>
  </head>
  <body>
    <!--<canvas id="myCanvas" width="512" height="512"></canvas>-->
<script>
'use strict';

//var canvas = document.getElementById('myCanvas');
//var ctx = canvas.getContext('2d');

//var cw=canvas.width;
//var ch=canvas.height;
//canvas.style.border='1px solid red';


//Are 2 convex polygons colliding?

// polygon objects are an array of vertices forming the polygon
// var polygon1=[{x:100,y:100},{x:150,y:150},{x:50,y:150},...];
// THE POLYGONS MUST BE CONVEX
// return true if the 2 polygons are colliding
function convexPolygonsCollide(a, b){
  var polygons = [a, b];
  var minA, maxA, projected, i, i1, j, minB, maxB;
  for(i = 0; i < polygons.length; i++){
    // for each polygon, look at each edge of the polygon, and determine if it separates the two shapes
    var polygon = polygons[i];
    for(i1 = 0; i1 < polygon.length; i1++){
      // grab 2 vertices to create an edge
      var i2 = (i1 + 1) % polygon.length;
      var p1 = polygon[i1];
      var p2 = polygon[i2];
      // find the line perpendicular to this edge
      var normal = { x: p2.y - p1.y, y: p1.x - p2.x };
      minA = maxA = undefined;
      // for each vertex in the first shape, project it onto the line perpendicular to the edge
      // and keep track of the min and max of these values
      for(j = 0; j < a.length; j++){
        projected = normal.x * a[j].x + normal.y * a[j].y;
        if(minA==undefined || projected < minA){
          minA = projected;
        }
        if(maxA==undefined || projected > maxA){
          maxA = projected;
        }
      }
      // for each vertex in the second shape, project it onto the line perpendicular to the edge
      // and keep track of the min and max of these values
      minB = maxB = undefined;
      for(j = 0; j < b.length; j++){
        projected = normal.x * b[j].x + normal.y * b[j].y;
        if(minB==undefined || projected < minB){
          minB = projected;
        }
        if(maxB==undefined || projected > maxB){
          maxB = projected;
        }
      }
      // if there is no overlap between the projects, the edge we are looking at separates the two
      // polygons, and we know there is no overlap
      if(maxA < minB || maxB < minA){
        return false;
      }
    }
  }
  return true;
};






</script>
  </body>
</html>
